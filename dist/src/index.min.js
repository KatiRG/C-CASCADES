!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}function a(t){return"object"==typeof t?null!==t:"function"==typeof t}function S(t){if(!a(t))throw TypeError(t+" is not an object!");return t}function l(t){try{return!!t()}catch(t){return!0}}function r(t){return i?n.createElement(t):{}}function b(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function c(t,e){return d.call(t,e)}function u(t){return"Symbol(".concat(void 0===t?"":t,")_",(++p+v).toString(36))}function x(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}function _(r,a,t){if(x(r),void 0===a)return r;switch(t){case 1:return function(t){return r.call(a,t)};case 2:return function(t,e){return r.call(a,t,e)};case 3:return function(t,e,n){return r.call(a,t,e,n)}}return function(){return r.apply(a,arguments)}}var g=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),h=t(function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)}),e=(h.version,!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),n=g.document,i=a(n)&&a(n.createElement),o=!e&&!l(function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}),s=Object.defineProperty,f={f:e?Object.defineProperty:function(t,e,n){if(S(t),e=function(t,e){if(!a(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!a(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),S(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},k=e?function(t,e,n){return f.f(t,e,b(1,n))}:function(t,e,n){return t[e]=n,t},d={}.hasOwnProperty,p=0,v=Math.random(),y=t(function(t){var e="__core-js_shared__",n=g[e]||(g[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:h.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),m=y("native-function-to-string",Function.toString),A=t(function(t){var i=u("src"),e="toString",o=(""+m).split(e);h.inspectSource=function(t){return m.call(t)},(t.exports=function(t,e,n,r){var a="function"==typeof n;a&&(c(n,"name")||k(n,"name",e)),t[e]!==n&&(a&&(c(n,i)||k(n,i,t[e]?""+t[e]:o.join(String(e)))),t===g?t[e]=n:r?t[e]?t[e]=n:k(t,e,n):(delete t[e],k(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[i]||m.call(this)})}),O="prototype",T=function(t,e,n){var r,a,i,o,c=t&T.F,u=t&T.G,s=t&T.S,l=t&T.P,f=t&T.B,d=u?g:s?g[e]||(g[e]={}):(g[e]||{})[O],p=u?h:h[e]||(h[e]={}),v=p[O]||(p[O]={});for(r in u&&(n=e),n)i=((a=!c&&d&&void 0!==d[r])?d:n)[r],o=f&&a?_(i,g):l&&"function"==typeof i?_(Function.call,i):i,d&&A(d,r,i,t&T.U),p[r]!=i&&k(p,r,o),l&&v[r]!=i&&(v[r]=i)};g.core=h,T.F=1,T.G=2,T.S=4,T.P=8,T.B=16,T.W=32,T.U=64,T.R=128;function w(t){return I.call(t).slice(8,-1)}function L(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}function E(t){return R(L(t))}function C(t){return isNaN(t=+t)?0:(0<t?N:F)(t)}function j(t){return 0<t?H(C(t),9007199254740991):0}function M(c){return function(t,e,n){var r,a=E(t),i=j(a.length),o=function(t,e){return(t=C(t))<0?G(t+e,0):$(t,e)}(n,i);if(c&&e!=e){for(;o<i;)if((r=a[o++])!=r)return!0}else for(;o<i;o++)if((c||o in a)&&a[o]===e)return c||o||0;return!c&&-1}}var P=T,I={}.toString,R=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==w(t)?t.split(""):Object(t)},F=Math.ceil,N=Math.floor,H=Math.min,G=Math.max,$=Math.min,z=t(function(t){var e=y("wks"),n=g.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:u)("Symbol."+t))}).store=e}),B=z("unscopables"),D=Array.prototype;null==D[B]&&k(D,B,{});function V(t){D[B][t]=!0}var W=M(!0);P(P.P,"Array",{includes:function(t){return W(this,t,1<arguments.length?arguments[1]:void 0)}}),V("includes");function U(t){var e;return a(t)&&(void 0!==(e=t[X])?!!e:"RegExp"==w(t))}var X=z("match"),Y=z("match"),q="includes";P(P.P+P.F*function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[Y]=!1,!"/./"[e](n)}catch(t){}}return!0}(q),"String",{includes:function(t){return!!~function(t,e,n){if(U(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(L(t))}(this,t,q).indexOf(t,1<arguments.length?arguments[1]:void 0)}});function J(t,e,n){return e+(n?rt(t,e).length:1)}function K(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),at))?n:it?w(e):"Object"==(r=w(e))&&"function"==typeof e.callee?"Arguments":r}function Q(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==K(t))throw new TypeError("RegExp#exec called on incompatible receiver");return ot.call(t,e)}var Z,tt,et,nt=z("species"),rt=(Z=!0,function(t,e){var n,r,a=String(L(t)),i=C(e),o=a.length;return i<0||o<=i?Z?"":void 0:(n=a.charCodeAt(i))<55296||56319<n||i+1===o||(r=a.charCodeAt(i+1))<56320||57343<r?Z?a.charAt(i):n:Z?a.slice(i,i+2):r-56320+(n-55296<<10)+65536}),at=z("toStringTag"),it="Arguments"==w(function(){return arguments}()),ot=RegExp.prototype.exec,ct=RegExp.prototype.exec,ut=String.prototype.replace,st=ct,lt="lastIndex",ft=(tt=/a/,et=/b*/g,ct.call(tt,"a"),ct.call(et,"a"),0!==tt[lt]||0!==et[lt]),dt=void 0!==/()??/.exec("")[1];(ft||dt)&&(st=function(t){var e,n,r,a,i=this;return dt&&(n=new RegExp("^"+i.source+"$(?!\\s)",function(){var t=S(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}.call(i))),ft&&(e=i[lt]),r=ct.call(i,t),ft&&r&&(i[lt]=i.global?r.index+r[0].length:e),dt&&r&&1<r.length&&ut.call(r[0],n,function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(r[a]=void 0)}),r});var pt=st;P({target:"RegExp",proto:!0,forced:pt!==/./.exec},{exec:pt});function vt(n,t,e){var r=z(n),i=!l(function(){var t={};return t[r]=function(){return 7},7!=""[n](t)}),a=i?!l(function(){var t=!1,e=/a/;return e.exec=function(){return t=!0,null},"split"===n&&(e.constructor={},e.constructor[gt]=function(){return e}),e[r](""),!t}):void 0;if(!i||!a||"replace"===n&&!ht||"split"===n&&!yt){var o=/./[r],c=e(L,r,""[n],function(t,e,n,r,a){return e.exec===pt?i&&!a?{done:!0,value:o.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),u=c[0],s=c[1];A(String.prototype,n,u),k(RegExp.prototype,r,2==t?function(t,e){return s.call(t,this,e)}:function(t){return s.call(t,this)})}}var gt=z("species"),ht=!l(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),yt=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),mt=Math.min,bt=[].push,xt="split",_t="length",kt="lastIndex",At=4294967295,St=!l(function(){});vt("split",2,function(a,i,h,y){var m;return m="c"=="abbc"[xt](/(b)*/)[1]||4!="test"[xt](/(?:)/,-1)[_t]||2!="ab"[xt](/(?:ab)*/)[_t]||4!="."[xt](/(.?)(.?)/)[_t]||1<"."[xt](/()()/)[_t]||""[xt](/.?/)[_t]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!U(t))return h.call(n,t,e);for(var r,a,i,o=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,s=void 0===e?At:e>>>0,l=new RegExp(t.source,c+"g");(r=pt.call(l,n))&&!(u<(a=l[kt])&&(o.push(n.slice(u,r.index)),1<r[_t]&&r.index<n[_t]&&bt.apply(o,r.slice(1)),i=r[0][_t],u=a,o[_t]>=s));)l[kt]===r.index&&l[kt]++;return u===n[_t]?!i&&l.test("")||o.push(""):o.push(n.slice(u)),o[_t]>s?o.slice(0,s):o}:"0"[xt](void 0,0)[_t]?function(t,e){return void 0===t&&0===e?[]:h.call(this,t,e)}:h,[function(t,e){var n=a(this),r=null==t?void 0:t[i];return void 0!==r?r.call(t,n,e):m.call(String(n),t,e)},function(t,e){var n=y(m,t,this,e,m!==h);if(n.done)return n.value;var r=S(t),a=String(this),i=function(t,e){var n,r=S(t).constructor;return void 0===r||null==(n=S(r)[nt])?e:x(n)}(r,RegExp),o=r.unicode,c=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(St?"y":"g"),u=new i(St?r:"^(?:"+r.source+")",c),s=void 0===e?At:e>>>0;if(0==s)return[];if(0===a.length)return null===Q(u,a)?[a]:[];for(var l=0,f=0,d=[];f<a.length;){u.lastIndex=St?f:0;var p,v=Q(u,St?a:a.slice(f));if(null===v||(p=mt(j(u.lastIndex+(St?0:f)),a.length))===l)f=J(a,f,o);else{if(d.push(a.slice(l,f)),d.length===s)return d;for(var g=1;g<=v.length-1;g++)if(d.push(v[g]),d.length===s)return d;f=l=p}}return d.push(a.slice(l)),d}]});function Ot(t){return Object(L(t))}var Tt=Math.max,wt=Math.min,Lt=Math.floor,Et=/\$([$&`']|\d\d?|<[^>]*>)/g,Ct=/\$([$&`']|\d\d?)/g;vt("replace",2,function(a,i,_,k){return[function(t,e){var n=a(this),r=null==t?void 0:t[i];return void 0!==r?r.call(t,n,e):_.call(String(n),t,e)},function(t,e){var n=k(_,t,this,e);if(n.done)return n.value;var r=S(t),a=String(this),i="function"==typeof e;i||(e=String(e));var o=r.global;if(o){var c=r.unicode;r.lastIndex=0}for(var u=[];;){var s=Q(r,a);if(null===s)break;if(u.push(s),!o)break;""===String(s[0])&&(r.lastIndex=J(a,j(r.lastIndex),c))}for(var l,f="",d=0,p=0;p<u.length;p++){s=u[p];for(var v=String(s[0]),g=Tt(wt(C(s.index),a.length),0),h=[],y=1;y<s.length;y++)h.push(void 0===(l=s[y])?l:String(l));var m=s.groups;if(i){var b=[v].concat(h,g,a);void 0!==m&&b.push(m);var x=String(e.apply(void 0,b))}else x=A(v,a,g,h,m,e);d<=g&&(f+=a.slice(d,g)+x,d=g+v.length)}return f+a.slice(d)}];function A(i,o,c,u,s,t){var l=c+i.length,f=u.length,e=Ct;return void 0!==s&&(s=Ot(s),e=Et),_.call(t,e,function(t,e){var n;switch(e.charAt(0)){case"$":return"$";case"&":return i;case"`":return o.slice(0,c);case"'":return o.slice(l);case"<":n=s[e.slice(1,-1)];break;default:var r=+e;if(0==r)return t;if(f<r){var a=Lt(r/10);return 0===a?t:a<=f?void 0===u[a-1]?e.charAt(1):u[a-1]+e.charAt(1):t}n=u[r-1]}return void 0===n?"":n})}});var jt,Mt,Pt=/"/g;(Mt={})[jt="link"]=function(e){return function(t){return e(this,"a","href",t)}}(function(t,e,n,r){var a=String(L(t)),i="<"+e;return""!==n&&(i+=" "+n+'="'+String(r).replace(Pt,"&quot;")+'"'),i+">"+a+"</"+e+">"}),P(P.P+P.F*l(function(){var t=""[jt]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",Mt);function It(t,e){return!!t&&l(function(){e?t.call(null,function(){},1):t.call(null)})}var Rt=[].sort,Ft=[1,2,3];P(P.P+P.F*(l(function(){Ft.sort(void 0)})||!l(function(){Ft.sort(null)})||!It(Rt)),"Array",{sort:function(t){return void 0===t?Rt.call(Ot(this)):Rt.call(Ot(this),x(t))}});var Nt=f.f,Ht=Function.prototype,Gt=/^\s*function ([^ (]*)/;"name"in Ht||e&&Nt(Ht,"name",{configurable:!0,get:function(){try{return(""+this).match(Gt)[1]}catch(t){return""}}});function $t(t,e){return new(function(t){var e;return Bt(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!Bt(e.prototype)||(e=void 0),a(e)&&null===(e=e[Dt])&&(e=void 0)),void 0===e?Array:e}(t))(e)}function zt(f,t){var d=1==f,p=2==f,v=3==f,g=4==f,h=6==f,y=5==f||h,m=t||$t;return function(t,e,n){for(var r,a,i=Ot(t),o=R(i),c=_(e,n,3),u=j(o.length),s=0,l=d?m(t,u):p?m(t,0):void 0;s<u;s++)if((y||s in o)&&(a=c(r=o[s],s,i),f))if(d)l[s]=a;else if(a)switch(f){case 3:return!0;case 5:return r;case 6:return s;case 2:l.push(r)}else if(g)return!1;return h?-1:v||g?g:l}}var Bt=Array.isArray||function(t){return"Array"==w(t)},Dt=z("species"),Vt=zt(1);P(P.P+P.F*!It([].map,!0),"Array",{map:function(t){return Vt(this,t,arguments[1])}});var Wt=zt(0),Ut=It([].forEach,!0);P(P.P+P.F*!Ut,"Array",{forEach:function(t){return Wt(this,t,arguments[1])}});function Xt(t,e){return{value:e,done:!!t}}function Yt(t){return Qt[t]||(Qt[t]=u(t))}function qt(){}function Jt(t,e,n){t&&!c(t=n?t:t.prototype,fe)&&le(t,fe,{configurable:!0,value:e})}var Kt={},Qt=y("keys"),Zt=M(!1),te=Yt("IE_PROTO"),ee="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ne=Object.keys||function(t){return function(t,e){var n,r=E(t),a=0,i=[];for(n in r)n!=te&&c(r,n)&&i.push(n);for(;e.length>a;)c(r,n=e[a++])&&(~Zt(i,n)||i.push(n));return i}(t,ee)},re=e?Object.defineProperties:function(t,e){S(t);for(var n,r=ne(e),a=r.length,i=0;i<a;)f.f(t,n=r[i++],e[n]);return t},ae=g.document,ie=ae&&ae.documentElement,oe=Yt("IE_PROTO"),ce="prototype",ue=function(){var t,e=r("iframe"),n=ee.length;for(e.style.display="none",ie.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ue=t.F;n--;)delete ue[ce][ee[n]];return ue()},se=Object.create||function(t,e){var n;return null!==t?(qt[ce]=S(t),n=new qt,qt[ce]=null,n[oe]=t):n=ue(),void 0===e?n:re(n,e)},le=f.f,fe=z("toStringTag"),de={};k(de,z("iterator"),function(){return this});function pe(){return this}var ve=Yt("IE_PROTO"),ge=Object.prototype,he=Object.getPrototypeOf||function(t){return t=Ot(t),c(t,ve)?t[ve]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ge:null},ye=z("iterator"),me=!([].keys&&"next"in[].keys()),be="values",xe=function(t,e,n,r,a,i,o){!function(t,e,n){t.prototype=se(de,{next:b(1,n)}),Jt(t,e+" Iterator")}(n,e,r);function c(t){if(!me&&t in v)return v[t];switch(t){case"keys":case be:return function(){return new n(this,t)}}return function(){return new n(this,t)}}var u,s,l,f=e+" Iterator",d=a==be,p=!1,v=t.prototype,g=v[ye]||v["@@iterator"]||a&&v[a],h=g||c(a),y=a?d?c("entries"):h:void 0,m="Array"==e&&v.entries||g;if(m&&(l=he(m.call(new t)))!==Object.prototype&&l.next&&(Jt(l,f,!0),"function"!=typeof l[ye]&&k(l,ye,pe)),d&&g&&g.name!==be&&(p=!0,h=function(){return g.call(this)}),!me&&!p&&v[ye]||k(v,ye,h),Kt[e]=h,Kt[f]=pe,a)if(u={values:d?h:c(be),keys:i?h:c("keys"),entries:y},o)for(s in u)s in v||A(v,s,u[s]);else P(P.P+P.F*(me||p),e,u);return u}(Array,"Array",function(t,e){this._t=E(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Xt(1)):Xt(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Kt.Arguments=Kt.Array,V("keys"),V("values"),V("entries");for(var _e=z("iterator"),ke=z("toStringTag"),Ae=Kt.Array,Se={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Oe=ne(Se),Te=0;Te<Oe.length;Te++){var we,Le=Oe[Te],Ee=Se[Le],Ce=g[Le],je=Ce&&Ce.prototype;if(je&&(je[_e]||k(je,_e,Ae),je[ke]||k(je,ke,Le),Kt[Le]=Ae,Ee))for(we in xe)je[we]||A(je,we,xe[we],!0)}var Me={};Me[z("toStringTag")]="z",Me+""!="[object z]"&&A(Object.prototype,"toString",function(){return"[object "+K(this)+"]"},!0);var Pe=zt(2);P(P.P+P.F*!It([].filter,!0),"Array",{filter:function(t){return Pe(this,t,arguments[1])}});function Ie(t){return Fe(t)}var Re="Tg C yr <sup>-1</sup>",Fe=d3.format(".2f");function Ne(r,t,e,n){var a=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),i={"#stackedbar_SA":25,"#stackedbar_Africa":10,"#stackedbar_Asia":15,"#stackedbar_NAmer":5,"#stackedbar_Oceania":2,"#stackedbar_Europe":5}[r],o=20,c=17,u=40,s=n-u-o,l=e-i-c,f=d3.scale.ordinal().rangeRoundBands([0,s],.1),d=d3.scale.linear().rangeRound([l,0]),p=d3.scale.ordinal().range(["#A9C1D9","#607890","#ABBE71"]),v=d3.svg.axis().scale(f).orient("bottom"),g="#stackedbar_Oceania"===r?1:3,h=d3.svg.axis().scale(d).orient("left").tickFormat(d3.format(".2s")).ticks(g),y=d3.select(r).append("div").append("svg").attr("width",s+u+o).attr("height",l+i+c).append("g").attr("transform","translate("+u+","+i+")");d3.csv(t,function(t,e){if(t)throw t;p.domain(d3.keys(e[0]).filter(function(t){return"country"!==t})),e.forEach(function(e){var n=e.country,r=0;e.flux=p.domain().map(function(t){return{country:n,loac:t,y0:r,y1:r+=+e[t]}}),e.total=e.flux[e.flux.length-1].y1}),e.sort(function(t,e){return e.total-t.total}),f.domain(e.map(function(t){return t.country})),d.domain([0,d3.max(e,function(t){return t.total})]),"#stackedbar_SA"===r&&y.append("g").attr("class","tick").append("text","text").attr("x",-40).attr("y",-8).html("Tg C yr").style("font-size","11px").append("tspan").text("-1").style("font-size","11px").attr("dx",".01em").attr("dy","-.2em"),y.append("g").attr("class","x axis").attr("transform","translate(0,"+l+")").call(v),y.append("g").attr("class","y axis").call(h).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end");var n=y.selectAll(".country").data(e).enter().append("g").attr("class","g").attr("transform",function(){return"translate(0,0)"});n.selectAll("rect").data(function(t){return t.flux}).enter().append("rect").attr("width",f.rangeBand()).attr("y",function(t){return d(t.y1)}).attr("x",function(t){return f(t.country)}).attr("height",function(t){return d(t.y0)-d(t.y1)}).style("fill",function(t){return p(t.loac)}),n.selectAll("rect").on("mousemove",function(t){var e=t.y1-t.y0;a.transition().style("opacity",.9),a.html("<b>"+t.loac+"</b><br><br><table><tr><td><b>"+Ie(e)+"</td><td> "+Re+"</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-90+"px")}).on("mouseout",function(){a.transition().style("opacity",0)})})}function He(t,e,a){var n=0,r=0,i=0,o=0,c=460-o-r,u=900-n-i,s=d3.select(t).append("svg").attr("width",c+o+r).attr("height",u+n+i).append("g").attr("transform","translate("+o+","+n+")"),l=d3.sankey().nodeWidth(30).nodePadding(20).size([c,u]),f=l.link(),d={Tropics:"Tropics (> 50 degrees)","High lat":"High latitudes (< -50 degrees)","Mid lat":"Mid latitudes (30â50 degrees)"};d3.json(e,function(t,e){!function(t){var e={};t.nodes.forEach(function(t){e[t.name]=t}),t.links=t.links.map(function(t){return{source:e[t.source],target:e[t.target],value:t.value}}),t.nodes.sort(function(t,e){return d3.descending(t.value,e.value)}),l.nodes(t.nodes).links(t.links).layout(32);var n=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);s.append("g").selectAll(".link").data(t.links).enter().append("path").attr("class",function(t){return"link "+("from"+t.source.name.replace(/\s+/g,"")+a)+" "+("to"+t.target.name.replace(/\s+/g,"")+a)}).attr("d",f).attr("id",function(t,e){return t.id=e,"chart"+a+"_link-"+e}).style("stroke-width",function(t){return Math.max(1,t.dy)}).sort(function(t,e){return e.dy-t.dy}).on("mousemove",function(t){d3.selectAll(".link:not(#"+this.id+")").style("opacity",.5),function(t,e){d3.selectAll("rect").classed("rectInactive",!0);var n=0<t.source.sourceLinks.length?t.source.name:t.target.name,r=d3.select("#"+e.id).attr("class").split(" ").filter(function(t){return t.includes("to")})[0].split("to")[1].slice(0,-1);d3.select("#chart"+a).select("rect."+n).classed("rectInactive",!1),d3.select("#chart"+a).select("rect."+r).classed("rectInactive",!1)}(t,this);var e="Tropics"===t.source.name||"Mid lat"===t.source.name||"High lat"===t.source.name?d[t.source.name]:t.source.name;n.transition().style("opacity",.9),n.html("<b>"+e+"</b><br><br><table><tr><td>"+t.target.name+" flux: </td><td><b>"+Ie(t.value)+"</td><td> "+Re+"</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-90+"px")}).on("mouseout",function(){d3.selectAll(".link:not(#chart"+a+"_"+this.id+")").style("opacity",1),d3.selectAll("rect").classed("rectInactive",!1),n.transition().style("opacity",0)});var r=s.append("g").selectAll(".node").data(t.nodes).enter().append("g").attr("class",function(){return"node regions"}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).style("cursor",function(){return"crosshair"});r.append("rect").attr("height",function(t){return t.dy}).attr("width",l.nodeWidth()).attr("class",function(t){return t.name.replace(/\s/g,"")}),r.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){return"Tropics"===t.name||"Mid lat"===t.name||"High lat"===t.name?d[t.name]:t.name}).style("font-weight","bold").filter(function(t){return t.x<c/2}).attr("x",6+l.nodeWidth()).attr("text-anchor","start"),r.on("mousemove",function(t){!function(t){var e,n;d3.select("#chart"+a).selectAll("rect:not(."+t.name.replace(/\s+/g,"")+")").classed("rectInactive",!0),d3.selectAll(".link").classed("inactive",!0),0<t.sourceLinks.length?(t.sourceLinks.map(function(t){e=t.target.name.replace(/\s+/g,""),d3.select("#chart"+a).select("rect."+e).classed("rectInactive",!1)}),n=d3.selectAll(".from"+t.name.replace(/\s+/g,"")+a)):0<t.targetLinks.length&&(t.targetLinks.map(function(t){e=t.source.name.replace(/\s+/g,""),d3.select("#chart".concat(a)).select("rect.".concat(e)).classed("rectInactive",!1)}),n=d3.selectAll(".to"+t.name.replace(/\s+/g,"")+a)),n.classed("inactive",!n.classed("inactive")),n.classed("active",!0)}(t);var e="Tropics"===t.name||"Mid lat"===t.name||"High lat"===t.name?d[t.name]:t.name;n.transition().style("opacity",.9),n.html("<b>"+e+"</b><br><br><table><tr><td> Total flux: </td><td><b>"+Ie(t.value)+"</td><td> "+Re+"</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-90+"px")}).on("mouseout",function(){d3.selectAll(".inactive").classed("inactive",!1),d3.selectAll(".active").classed("active",!1),d3.selectAll("rect").classed("rectInactive",!1),n.transition().style("opacity",0)})}(e)})}He("#chart1","data/LOAC_budget_TgCyr181113_sankey1.json",1),He("#chart2","data/LOAC_budget_TgCyr181113_sankey2.json",2),Ne("#stackedbar_SA","data/LOAC_budget_TgCyr181113_stackedbar_SAmer.csv",225,220),Ne("#stackedbar_Africa","data/LOAC_budget_TgCyr181113_stackedbar_Africa.csv",135,140),Ne("#stackedbar_Asia","data/LOAC_budget_TgCyr181113_stackedbar_Asia.csv",245,190),Ne("#stackedbar_NAmer","data/LOAC_budget_TgCyr181113_stackedbar_NAmer.csv",180,130),Ne("#stackedbar_Oceania","data/LOAC_budget_TgCyr181113_stackedbar_Oceania.csv",35,130),Ne("#stackedbar_Europe","data/LOAC_budget_TgCyr181113_stackedbar_Europe.csv",70,180)}();